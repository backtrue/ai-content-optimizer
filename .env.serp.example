# SERP API 配置
# 支援多個服務和多個 API Key，自動輪換和容錯

# SerpAPI (https://serpapi.com)
# 支援多個 API Key (逗號分隔)，當一個配額超限時自動切換
SERPAPI_KEYS=60832254557993e92785c5c7dc017ccb4ac153a78c4bbb27b978d323785506be,d5d040588a63fe91e0643b2a7ee1e4a8778ea777d0a9f7e065f77cd05b2a05db
SERPAPI_ENABLED=true
SERP_API_KEY_ROTATION=round-robin
SERP_API_KEY_COOLDOWN_SECONDS=180
SERP_LOG_API_KEY_ROTATION=true

# ValueSERP (https://www.valueserp.com)
# 支援多個 API Key (逗號分隔)
# 範例: VALUESERP_KEYS=key1,key2,key3
VALUESERP_KEYS=297CBA37136D44EDBF0EB9D37CBFBBA3,95A6F2493F944B5984BE498A9AB52528
VALUESERP_ENABLED=true
VALUESERP_API_KEY_ROTATION=round-robin
VALUESERP_API_KEY_COOLDOWN_SECONDS=180
VALUESERP_LOG_API_KEY_ROTATION=true

# ZenSERP (https://zenserp.com)
# 支援多個 API Key (逗號分隔)
ZENSERP_KEYS=7d7d4dd0-b4e1-11f0-b53a-0fc19c7fd201,cfefd3d0-b679-11f0-88dc-69458611bb0c
ZENSERP_ENABLED=true
ZENSERP_API_KEY_ROTATION=round-robin
ZENSERP_API_KEY_COOLDOWN_SECONDS=180
ZENSERP_LOG_API_KEY_ROTATION=true

# API Key 輪換策略
# round-robin: 依序輪換 API Key
# random: 隨機選擇 API Key
# priority: 優先使用第一個 API Key，失敗時切換
SERP_API_KEY_ROTATION=round-robin

# 服務輪換策略
# fallback: 按優先順序嘗試，失敗時切換到下一個
# priority: 優先使用優先級高的服務
# round-robin: 均勻分配請求
SERP_ROTATION_STRATEGY=fallback

# 服務優先順序 (用於 priority/fallback 模式)
# 格式: 逗號分隔的服務名稱
SERP_SERVICE_PRIORITY=serpapi,valueserp,zenserp

# 重試配置
SERP_MAX_RETRIES=3
SERP_RETRY_DELAY_MS=1000

# 速率限制 (每分鐘請求數)
SERP_RATE_LIMIT_RPM=60

# 日誌和調試
SERP_DEBUG=false
SERP_LOG_FAILURES=true
SERP_LOG_API_KEY_ROTATION=true

# Cloud Tasks / Cloud Run 佇列設定
# SERP_GCP_PROJECT 可覆寫 gcloud 預設專案，若已使用 gcloud config 可留空
SERP_GCP_PROJECT=ragseo-476701
# Cloud Run Worker 對外 URL（部署後更新為實際值）
SERP_WORKER_URL=https://serp-worker-111372240022.asia-east1.run.app
# Cloud Tasks queue 與地區
SERP_TASK_QUEUE=serp-collection
SERP_TASK_LOCATION=asia-east1
# 投遞佇列時使用的 Service Account
SERP_TASK_SERVICE_ACCOUNT=serp-worker@ragseo-476701.iam.gserviceaccount.com
# 批次大小與批次間隔（秒）
SERP_TASK_BATCH_SIZE=5
SERP_TASK_SPACING_SECONDS=15
# 覆寫 worker 內部等待時間（秒），0 表示使用程式預設值
SERP_TASK_KEYWORD_DELAY=0
SERP_TASK_URL_DELAY=8
# 若 Cloud Run Worker 需設定 Audience，可在此覆寫（否則沿用 SERP_WORKER_URL）
SERP_TASK_AUDIENCE=

# Google Sheets 憑證設定
SHEETS_CREDENTIALS_PATH=./serp-sheet-writer-key.json
SHEETS_TRAINING_DATA_ID=
SHEETS_TRAINING_DATA_TAB=
